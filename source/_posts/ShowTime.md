---
title:  ShowTime
categories: ctf
date: 2022/12/12
tags: 刷题记录
---

Tokeii师傅在i春秋上出的一道题，挺新奇的，记录一下

![image-20221212225834839](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221212225834839.png)

思路源于他的这篇[博客](https://blog.csdn.net/u010418732/article/details/125178250?spm=1001.2014.3001.5502)

下载后的附件，名字都是base64编码的，写脚本改名

```shell
p=r'C:\Users\19682\Desktop\stego{}'.format('\\')
for i in filelist:
    b=i[:-4]
    a=base64.b64decode(b)
    c=a.decode('UTF-8')
    d=os.rename(p+i,p+c+'.txt')
```

![image-20221212230030820](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221212230030820.png)

提取每个文件修改时间戳的最后一位

```shell
import os
for i in range(925):
    filename = r"C:\Users\19682\Desktop\stego\{}.txt".format(i)
    file_attr = os.stat(filename)#读取文件属性
    create_time = str(file_attr.st_mtime)#获取修改时间
    # print(create_time)
    print(int(create_time[9:10]),end='')
```

将数字转字符串

```shell
from numlib import *
a=1774674557824868457499061032120895601890679002715594296727500711025736399907449201395656994728720806964341210442762667972497818255944821704615312664370539310702290900650405564784263444957700019095984690444788205828883771674746086773438649406269794894162345496646835920006634655790770023591140601368298957582899939643842210521270729599027362038934484123582308984705653794101554567102555263227506545092094002357706759680210528515040207139078660910227189154726011658251525180920105580373673544062554076786313766549322038531510544996944293029774158028502472577209425526755227464619459049995527828690565067923263594211663575768777749797684020900044480050567580861721772084896501068329188549341576999149193729307442677823665245077311594986800407693715823937313065541334395357854650051549808442561638033762084503042808464197473992558178954715114984494063565778497512453063854507422273051449037068016131470694073345956605305655737661
print (n2s(a))
```

得到一串base64

![image-20221212230901285](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221212230901285.png)

拿到cyberchef解码保存为7z文件解压后打开即得flag