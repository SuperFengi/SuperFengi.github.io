---
title:  首届“天权信安&catf1ag”网络安全联合公开赛
categories: ctf
toc: true
date: 2022/12/9
tags: 比赛
---

比赛介绍：
本次竞赛旨在通过以赛促学、以赛促进的竞赛提升方式，面向网络安全从业者、兴趣爱好者、在校学生，通过竞技比武，检验参赛人员的网络安全综合能力，培养和选拔一批高素质网络安全人才，进而营造良好的网络安全知识学习和技能提升氛围，吸引更多高校学生投身网络强国建设事业，推动网络安全人才的培养，以及加快高校网络安全人才的储备，为国家网络安全建设添砖加瓦，为行业技术提升创新贡献自己的力量。

比赛总结：

赛题难度适中，自身仍有很大提升空间orz

# Crypto

## **疑惑**

exp:

```she
# 题目介绍：我好"疑惑"啊
# keys1 = welcome_to_nine-ak_match_is_so_easy_!@!
# keys2 = 20 4 24 5 94 12 2 36 26 6 49 11 68 15 14 114 12 10 43 14 9 43 10 27 31 31 22 45 10 48 58 4 18 10 38 31 14 97 92
a=[20,4,24,5,94,12,2,36,26,6,49,11,68,15,14,114,12,10,43,14,9,43,10,27,31,31,22,45,10,48,58,4,18,10,38,31,14,97,92]
b='welcome_to_nine-ak_match_is_so_easy_!@!'
for i in range(len(b)):
    print(chr(ord(b[i])^a[i]),end='')
```

catf1ag{nine-ak_match_is@very_easy_@/!} 

## **easyrsa**

exp：

```shell
from Crypto.Util.number import *
e = 0x10001
d=12344766091434434733173074189627377553017680360356962089159282442350343171988536143126785315325155784049041041740294461592715296364871912847202681353107182427067350160760722505537695351060872358780516757652343767211907987297081728669843916949983336698385141593880433674937737932158161117039734886760063825649623992179585362400642056715249145349214196969590250787495038347519927017407204272334005860911299915001920451629055970214564924913446260348649062607855669069184216149660211811217616624622378241195643396616228441026080441013816066477785035557421235574948446455413760957154157952685181318232685147981777529010093
c=11665709552346194520404644475693304343544277312139717618599619856028953672850971126750357095315011211770308088484683204061365343120233905810281045824420833988717463919084545209896116273241788366262798828075566212041893949256528106615605492953529332060374278942243879658004499423676775019309335825331748319484916607746676069594715000075912334306124627379144493327297854542488373589404460931325101587726363963663368593838684601095345900109519178235587636259017532403848656471367893974805399463278536349688131608183835495334912159111202418065161491440462011639125641718883550113983387585871212805400726591849356527011578
n=13717871972706962868710917190864395318380380788726354755874864666298971471295805029284299459288616488109296891203921497014120460143184810218680538647923519587681857800257311678203773339140281665350877914208278709865995451845445601706352659259559793431372688075659019308448963678380545045143583181131530985665822655263963917413080872997526445384954610888776917323156325542921415838122754036103689148810677276471252057077595104724365967333418002158480223657363936976281758713027828747277980907153645847605403914070601944617432177385048803228970693240587900504431163155958465431312258451026447435473865563581029300541109
m=pow(c,d,n)
print(long_to_bytes(m))
```

flag{3895dfda-67b1-11ed-b784-b07b2568d266}

## **passwd**

exp:

```she
from hashlib import *

a=''
for i in range(1,13):
    for j in range(1,32):
        for m in range(1,25):
            for n in range(1,61):
                c='2022'+str("%02d" % i)+''+str("%02d" % j)+''+str("%02d" % m)+''+str("%02d" % n)+''
                d=sha256(c.encode('utf-8')).hexdigest()
                if d=='69d00d9bc39e01687abf84e98e27c889cf1442b53edba27d3235acbeb7b0ae95':
                    print(c)
```

catf1ag{202211121750} 

# Misc

## **十位马**

将文件里的16进制放到cyberchef转hex再倒序，以zip格式保存

![image-20221209181915693](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221209181915693.png)

打开发现一对正方形图片

![image-20221209182110041](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221209182110041.png)

根据具有顺序的名字，考虑进行拼图

脚本：

```she
from PIL import Image
import binascii
import base64

a=Image.new('RGB',(300,300),'white')
n=0
for i in range(10):
    for j in range(10):
        b=Image.open(f'./WHAT_1S_FLAG/WHAT_1S_FLAG_{n}.png')
        a.paste(b,(30*j,30*i))
        n+=1
a.save('7.png')
```

拼好的图片：

![image-20221209182224527](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221209182224527.png)

手动ps上两个定位符，到在线网站进行识别

![image-20221209182326207](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221209182326207.png)

flag{cbef4c93-5e9c-11ed-8205-666c80085daf}

## **简单隐写**（复现）

图片尾部存在rar压缩包，kali里面dd命令分离

压缩包加密

由于没有见过这种隐写，一直也没有写出来

考查jphide隐写

使用jphs无密码解密

![image-20221211212406344](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211212406344.png)

![image-20221211212436987](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211212436987.png)

主要也不清楚该隐写有什么特征，问群友说一个一个试，还是见得太少了orz

使用密码解压

![image-20221211212625774](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211212625774.png)

凯撒密码：

![image-20221211212723989](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211212723989.png)

## **阿sir**（复现）

以为相对拿手的电子取证来了，结果到快结束才找到能解这个零宽的网站orz

零宽解密:

![image-20221211213136129](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211213136129.png)

取证大师挂载

发现桌面上的一张图片16进制末尾有东西

![image-20221211214832995](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211214832995.png)

将megrez前面的字母和数字以及最后的’=‘提取出来

得到

![image-20221211215218695](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211215218695.png)

解一下base

![image-20221211215333849](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211215333849.png)

缓存记录里可以看到缓存了两个百度网盘的文件

![image-20221211220106436](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211220106436.png)

上面的密码解不开

后来发现是最后一个是大写字母I而不是小写字母l

有点脑洞有点坑。。。

![image-20221211220225618](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211220225618.png)

![image-20221211220237325](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211220237325.png)

给了图片和一些名字不同的压缩包，压缩包名在传递信息，结合图片名中的stego应该是lsb隐写

人为创的压缩包肯定存在创建的时间顺序

写脚本解一下名字：

```she
import os
filelist = os.listdir(r'C:\Users\19682\Desktop\123')
dir_list = sorted(filelist,key=lambda x: os.path.getmtime(os.path.join(r'C:\Users\19682\Desktop\123', x)))
for i in dir_list:
    print(chr(int(i.split('.')[0][1:])),end='')
```

![image-20221211222703931](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211222703931.png)

继续凯撒爆破一下

![image-20221211222728304](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211222728304.png)

解密得到flag

![image-20221211222956886](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211222956886.png)

![image-20221211223052426](https://picture-1312836458.cos.ap-beijing.myqcloud.com/img/image-20221211223052426.png)

